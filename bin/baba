#!/usr/bin/env coffee

fs = require 'fs'
path = require 'path'
vm = require 'vm'
{spawn} = require 'child_process'
opts = require 'opts'


opts.parse [
  {
    short: 'e'
    long: 'eval'
    description: 'human exec'
    value: true
  }
], true

e = opts.get 'e'
if e
  Baba = require "../lib/script"
  baba = new Baba 'takumibaba'
  baba.exec e, {}, (result) ->
    console.log result
    process.exit()
else
  filename = process.argv[2]
  filepath = path.resolve filename
  spawn('coffee', [[filepath]], {detached: true}).stdout.on "data", (data) ->
    process.exit()
